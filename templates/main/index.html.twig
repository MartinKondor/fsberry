{% extends 'layout/base.html.twig' %}

{% block title %}Home{% endblock %}
{% block stylesheets %}{% endblock %}

{% block body %}
   <section class="row">
      <div class="col-lg-7 newpost-card mx-auto ">
         <form action="{{ asset('auth/newpost') }}" method="POST">
            <textarea class="form-control mb-1" name="postContent" placeholder="Share something ..." required></textarea>
            <button type="submit" class="btn btn-primary btn-block">Share</button>
         </form>
      </div>
      <div id="quote" class="col-lg-5"></div>
   </section>
   <section class="row">
      <div class="col-lg-7">
         {% if posts is defined %}
         {% for post in posts %}
            <article class="post animated">
               <div class="post-title">
                  <span class="uploader">
                     <img class="img-responsive xs-profile" src="{{ asset("images/profiles/" ~ post.uploaderProfilePic) }}" alt="Profile icon of {{ post.uploader }},">
                     <a href="{{ asset('u/' ~ post.uploaderLink) }}">{{ post.uploader }}</a>
                  </span>
                  <span class="post-time">{{ post.dateOfUpload | date('Y-m-d G:i') }}</span>
               </div>
               <p class="post-content">{{ post.content }}</p>
               <div class="post-info">
                  <a class="upvote-icon feed-icon" href="{{ asset('auth/upvote-' ~ post.postId) }}" title="Upvote this post">
                  {% if post.upvotedByUser %}
                     <i class="fas fa-thumbs-up"></i>
                  {% else %}
                     <i class="far fa-thumbs-up"></i>
                  {% endif %}
                  {{ post.upvotes }}
                  </a> 
                  &middot;
                  <a id="{{ 'post-' ~ post.postId ~ '-link'}}" class="feed-icon comment-link" href="#" title="Show the comments of this post"><i class="far fa-comment"></i> {{ post.comments | length }}</a>
               </div>
               <div id="{{ 'post-' ~ post.postId ~ '-comments' }}" class="post-comments animated fadeIn" style="display:none;">
               <form action="{{ asset('p/auth/newcomment') }}" method="POST">
                  <div class="input-group">
                     <textarea height="42" class="form-control" name="comment" placeholder="Write a comment here ..." required></textarea>
                     <input style="display:none;" type="text" name="postid" value="{{ post.postId }}">
                     <div class="input-group-append">
                        <button type="submit" class="btn btn-primary send-comment">Send</button>
                     </div>
                  </div>
               </form>
                  {% if post.comments is not null %}
                     {% for comment in post.comments %}
                        <div class="comment">
                           <div>
                              <a href="{{ asset('u/' ~ comment.commenterLink) }}" class="comment-commenter">
                                 <img class="xxs-profile" src="{{ asset('images/profiles/' ~ comment.commenterProfile) }}" alt="Profile picture of {{ comment.commenter }},">
                                 {{ comment.commenter }}
                              </a>
                              &middot;
                              <span class="comment-time">{{ comment.time }}</span>
                           </div>
                           <span class="comment-content">{{ comment.comment }}</span>
                        </div>
                     {% endfor %}
                  {% else %}
                     <p class="h3 mt-1">There are no comments on this post...</p>
                     <p>Be the first to comment on it</p>
                  {% endif %}
               </div>
            </article>
         {% endfor %}
      {% else %}
         <h1 class="mx-5 my-5">There are no post's to show!</h1>
         <p style="margin-bottom:500px !important;">Please come back later ...</p>
      {% endif %}
      </div>
      <div class="col-lg-5 animated fadeIn community-row">
         <div class="affix">
            Teams, chat ...
         </div>
      </div>
   </section>  
{% endblock %}

{% block javascripts %}
<script src="{{ asset('javascripts/quote.js') }}"></script>
{% endblock %}