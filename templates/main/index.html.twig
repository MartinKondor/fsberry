{% extends 'layout/base.html.twig' %}

{% block title %}Home{% endblock %}
{% block stylesheets %}{% endblock %}

{% block body %}
   <section class="row">
      <div class="col-lg-7 newpost-card mx-auto mt-5 animated zoomIn">
          <form action="{{ path("new_post") }}" method="POST" name="new_post_form">
              <textarea class="form-control mb-1" name="postContent" placeholder="Share something ..." required></textarea>
              <button type="submit" class="btn btn-primary btn-block">Share</button>
          </form>
      </div>
      <div id="quote" class="col-lg-5"></div>
   </section>
   <section class="row">
      <div class="col-lg-7">
         {% if posts is defined %}
         {% for post in posts %}
            <article class="post animated">
               <div class="post-title">
                  <a class="uploader" href="{{ path('view_user', { permalink: post.uploaderLink }) }}">
                      <img class="img-responsive xs-profile" src="{{ asset("images/profiles/" ~ post.uploaderProfilePic) }}" alt="Profile icon of {{ post.uploader }},">
                      {{ post.uploader }}
                   </a>
                  <span class="post-time">{{ post.dateOfUpload | date('Y-m-d G:i') }}</span>
               </div>
               <p class="post-content">{{ post.content }}</p>
               <div class="post-info">
                  <a class="upvote-icon feed-icon" href="{{ path("upvote", { entityId: post.postId }) }}" title="Upvote this post">
                      {% if post.isUpvotedByUser %}
                          <i class="fas fa-thumbs-up"></i>
                      {% else %}
                          <i class="far fa-thumbs-up"></i>
                      {% endif %}
                      {{ post.upvotes }}
                  </a> 
                  &middot;
                  <a id="{{ 'post-' ~ post.postId ~ '-link'}}" class="feed-icon comment-link" href="#" title="Show the comments of this post">
                     <i class="far fa-comment"></i> {{ post.comments | length }}
                  </a>
               </div>
               <div id="{{ 'post-' ~ post.postId ~ '-comments' }}" class="animated fadeIn" style="display:none;">
                   <div class="input-group comment-field">
                       <textarea id="{{ 'comment-area-' ~ post.postId }}" height="42" class="form-control" name="comment" placeholder="Write a comment here ..." required></textarea>
                       <div class="input-group-append">
                           <button href="{{ path('comment', { entityId: post.postId }) }}" type="submit" class="btn btn-info send-comment">Send</button>
                       </div>
                   </div>
                  {% if post.comments is not null %}
                     {% for comment in post.comments %}
                        <div class="comment">
                           <div>
                              <a href="{{ path('view_user', { permalink: comment.commenterLink }) }}" class="comment-commenter">
                                 <img class="xxs-profile" src="{{ asset('images/profiles/' ~ comment.commenterProfile) }}" alt="Profile picture of {{ comment.commenter }},">
                                 {{ comment.commenter }}
                              </a>
                              &middot;
                              <span class="comment-time">{{ comment.actionDate | date("Y-m-d") }}</span>
                           </div>
                           <span class="comment-content">{{ comment.content }}</span>
                        </div>
                     {% endfor %}
                  {% else %}
                     <p class="h3 mt-1">There are no comments on this post...</p>
                     <p>Be the first to comment on it</p>
                  {% endif %}
               </div>
            </article>
         {% endfor %}
      {% else %}
         <h1 class="mx-5 my-5">There are no post's to show!</h1>
         <p style="margin-bottom:500px !important;">Please come back later ...</p>
      {% endif %}
      </div>
      <div class="col-lg-5 animated fadeIn community-row">
         <div class="affix">
            Teams, chat ...
         </div>
      </div>
   </section>  
{% endblock %}

{% block javascripts %}
<script src="{{ asset('javascripts/quote.js') }}"></script>
{% endblock %}